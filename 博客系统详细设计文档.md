博客系统详细设计文档
1. 引言
1.1 文档目的

本设计文档用于指导开发一个简易博客系统。系统仅包含最基本的功能：

用户注册、登录、认证

文章创建、查看、删除

本系统旨在提供一个“轻量级、易维护、易实现”的博客系统方案，适合学习、教学或快速落地。

1.2 读者对象

后端开发者

学生/初学者

系统维护者

教学工作人员

2. 系统目标与范围
2.1 系统目标

实现一个最小可运行（MVP）的博客系统

接口清晰、简单、易实现

使用常见的技术栈（Spring Boot + JWT + MySQL）

2.2 功能范围（本版本仅包含）
模块	功能	说明
用户	注册	邮箱 + 密码 + 验证码
用户	登录	返回 JWT Token
用户	获取个人信息	通过 Token 获取
文章	创建文章	需登录
文章	获取文章列表	公开
文章	获取文章详情	公开
文章	删除文章	作者本人可删除
2.3 非目标（不在此版本实现）

评论、点赞、收藏

分类、标签

管理员后台

富文本上传、图片上传

通知系统

RBAC 权限体系

系统保持最小化实现。

3. 系统架构设计
3.1 整体架构

采用三层架构：

Controller → Service → Repository → MySQL


采用 JWT 无状态登录：

前端 → 带 JWT 的请求 → 后端 → 验证 → 执行操作

3.2 技术栈
层级	技术
后端	Spring Boot、Spring Web、Spring Data JPA
数据库	MySQL
认证	JWT
构建	Maven
开发环境	Java 17 / 11
4. 数据库设计
4.1 用户表（user）
CREATE TABLE user (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  email VARCHAR(255) NOT NULL UNIQUE,
  password VARCHAR(255) NOT NULL,
  nickname VARCHAR(100) NOT NULL,
  created_at DATETIME NOT NULL,
  updated_at DATETIME NOT NULL
);


字段说明：

字段	说明
email	登录账号，唯一。
password	可使用明文，或后续改为加密。
nickname	昵称。
created_at	注册时间。
updated_at	修改时间。
4.2 文章表（article）
CREATE TABLE article (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  author_id BIGINT NOT NULL,
  title VARCHAR(255) NOT NULL,
  content TEXT NOT NULL,
  cover_image VARCHAR(500),
  created_at DATETIME NOT NULL,
  updated_at DATETIME NOT NULL,
  FOREIGN KEY (author_id) REFERENCES user(id)
);


字段说明：

字段	说明
author_id	文章作者
title	文章标题
content	HTML 文本
cover_image	封面图地址，可空
created_at	创建时间
4.3 评论表（comment）
CREATE TABLE comment (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  article_id BIGINT NOT NULL,
  user_id BIGINT NOT NULL,
  content TEXT NOT NULL,
  created_at DATETIME NOT NULL,
  updated_at DATETIME NOT NULL,
  FOREIGN KEY (article_id) REFERENCES article(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES user(id),
  INDEX idx_article_id (article_id)
);


字段说明：

字段	说明
article_id	关联到文章表，表示评论属于哪篇文章
user_id	关联到用户表，表示评论的作者
content	评论内容
created_at	创建时间
updated_at	修改时间
使用 ON DELETE CASCADE 确保当文章删除时，相关评论也会被级联删除
5. 模块设计
5.1 用户模块设计
5.1.1 用例描述
UC-01 用户注册

输入邮箱、密码、昵称、验证码

后端验证邮箱是否重复

验证验证码是否正确

注册成功

UC-02 用户登录

输入邮箱 / 密码

校验后返回 JWT

UC-03 获取当前登录用户信息

前端携带 Token

后端解析 Token 并返回用户信息

5.1.2 类设计
User 实体类
@Entity
@Table(name = "user")
@Data
public class User {
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(unique = true, nullable = false)
    private String email;

    private String password;
    private String nickname;
    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}

UserRepository
public interface UserRepository extends JpaRepository<User, Long> {
    Optional<User> findByEmail(String email);
}

UserService
public interface UserService {
    void sendVerificationCode(String email);
    User register(UserRegisterDTO dto);
    User login(UserLoginDTO dto);
    User getCurrentUser();
}

UserController
@RestController
@RequestMapping("/api/users")
public class UserController {

    @PostMapping("/send-verification")
    public ResponseResult sendCode(@RequestBody EmailDTO dto) {...}

    @PostMapping("/register")
    public ResponseResult register(@RequestBody UserRegisterDTO dto) {...}

    @PostMapping("/login")
    public ResponseResult login(@RequestBody UserLoginDTO dto) {...}

    @GetMapping("/me")
    public ResponseResult me() {...}
}

5.1.3 注册流程图
用户 → 输入邮箱 → 请求验证码
       ↓
 后端生成验证码 → 保存到内存/数据库 → 发送邮件
       ↓
 用户输入验证码 + 注册信息
       ↓
 后端校验验证码 → 校验是否重复 → 创建用户 → 返回成功

5.2 文章模块设计
5.2.1 用例描述
UC-10 创建文章

用户已登录（JWT 认证）

输入标题、内容

系统保存文章并关联作者

UC-11 查询文章列表

不需要登录

UC-12 查询文章详情

不需要登录

UC-13 删除文章

登录用户只能删除自己的文章

5.2.2 类设计
Article 实体类
@Entity
@Table(name = "article")
@Data
public class Article {
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @ManyToOne
    @JoinColumn(name = "author_id")
    private User author;

    private String title;
    @Column(columnDefinition = "TEXT")
    private String content;
    private String coverImage;

    private LocalDateTime createdAt;
    private LocalDateTime updatedAt;
}

ArticleRepository
public interface ArticleRepository extends JpaRepository<Article, Long> {
    Page<Article> findAll(Pageable pageable);
}

ArticleService
public interface ArticleService {
    Article createArticle(ArticleCreateDTO dto, User author);
    Page<Article> getArticles(int page, int size);
    Article getArticle(Long id);
    void deleteArticle(Long id, User operator);
}

ArticleController
@RestController
@RequestMapping("/api/articles")
public class ArticleController {

    @PostMapping
    public ResponseResult create(@RequestBody ArticleCreateDTO dto) {...}

    @GetMapping
    public ResponseResult list(@RequestParam int page, @RequestParam int size) {...}

    @GetMapping("/{id}")
    public ResponseResult detail(@PathVariable Long id) {...}

    @DeleteMapping("/{id}")
    public ResponseResult delete(@PathVariable Long id) {...}
}

5.2.3 删除文章流程图
前端 → 请求DELETE /articles/{id}
               ↓
        后端获取当前用户
               ↓
    查询文章 → 是否存在?
               ↓
   文章.authorId == 当前用户?
         ↓              ↓
      是，删除文章      否，返回无权限

6. 安全设计
6.1 JWT Token 内容
字段	说明
userId	用户 ID
email	用户邮箱
iat	生成时间
exp	过期时间
6.2 Token 生成流程
String token = Jwts.builder()
    .setSubject(user.getId().toString())
    .claim("email", user.getEmail())
    .setExpiration(date)
    .signWith(SignatureAlgorithm.HS512, secret)
    .compact();

6.3 请求校验流程
请求进入 → JwtFilter 拦截 → 解析 Token
       ↓
Token 无效? → 拒绝访问
       ↓
Token 有效 → 放行并注入用户到 SecurityContext

7. 接口设计（更详细）
7.1 用户接口
① 发送验证码

POST /api/users/send-verification

请求：

{ "email": "test@example.com" }

② 注册

POST /api/users/register

请求：

{
  "email": "test@example.com",
  "password": "123456",
  "nickname": "Alice",
  "code": "123456"
}

③ 登录

POST /api/users/login

返回：

{
  "token": "eyJhbGciOi..."
}

④ 获取当前用户信息

GET /api/users/me

返回：

{
  "id": 1,
  "email": "test@example.com",
  "nickname": "Alice"
}

7.2 文章接口
⑤ 创建文章

POST /api/articles（需登录）

请求：

{
  "title": "My First Post",
  "content": "<p>Hello World</p>",
  "coverImage": ""
}

⑥ 获取文章列表

GET /api/articles?page=1&size=10

返回分页数据。

⑦ 获取文章详情

GET /api/articles/{id}

⑧ 删除文章

DELETE /api/articles/{id}（需作者权限）

8. 项目目录结构
backend/src/main/java/com/blog/
├── BlogApplication.java
├── common/
│   └── ResponseResult.java
├── security/
│   ├── JwtFilter.java
│   └── JwtProvider.java
├── user/
│   ├── controller/UserController.java
│   ├── service/UserService.java
│   ├── service/impl/UserServiceImpl.java
│   ├── repository/UserRepository.java
│   └── entity/User.java
└── article/
    ├── controller/ArticleController.java
    ├── service/ArticleService.java
    ├── service/impl/ArticleServiceImpl.java
    ├── repository/ArticleRepository.java
    └── entity/Article.java


简洁明了，适合小型项目。

9. 非功能性设计
9.1 性能

文章列表分页，避免一次性加载全部数据

数据量较小，无需缓存